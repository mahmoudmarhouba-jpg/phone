<div class="h-full bg-gray-100/70 dark:bg-black/50 backdrop-blur-xl text-gray-900 dark:text-white">
    <!-- Header -->
    <div class="p-4 pt-12">
        <div class="flex justify-between items-center mb-4">
             <button (click)="phoneState.navigateBack()" class="text-blue-500 dark:text-blue-400 text-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <h1 class="text-xl font-bold">Messages</h1>
            <button class="text-blue-500 dark:text-blue-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
            </button>
        </div>
    </div>

    <!-- Conversation List -->
    <div class="px-2 space-y-1">
        @for(convo of phoneState.conversations(); track convo.contact.id) {
            <div (click)="openConversation(convo)" class="flex items-center space-x-4 p-3 rounded-lg hover:bg-black/5 dark:hover:bg-white/10 cursor-pointer">
                <div class="relative flex-shrink-0">
                    <img [src]="convo.contact.avatar || 'https://i.pravatar.cc/150?u=' + convo.contact.id" class="w-14 h-14 rounded-full" alt="">
                </div>
                <div class="flex-grow overflow-hidden border-b border-gray-300 dark:border-gray-700 pb-3">
                    <div class="flex justify-between items-baseline">
                        <p class="font-bold text-lg truncate">{{ convo.contact.name }}</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400 flex items-center">
                            {{ convo.lastMessage.timestamp | date:'shortTime' }}
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1 text-gray-400 dark:text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </p>
                    </div>
                    <div class="flex items-center justify-between">
                        <p 
                            class="text-sm text-gray-600 dark:text-gray-400 truncate w-11/12"
                            [class.font-semibold]="!convo.lastMessage.read && !convo.lastMessage.isSender"
                            [class.text-gray-900]="!convo.lastMessage.read && !convo.lastMessage.isSender"
                            [class.dark:text-white]="!convo.lastMessage.read && !convo.lastMessage.isSender"
                        >
                            {{ convo.lastMessage.text }}
                        </p>
                        @if(!convo.lastMessage.read && !convo.lastMessage.isSender) {
                           <span class="block h-3 w-3 rounded-full bg-blue-500 flex-shrink-0"></span>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
</div>
